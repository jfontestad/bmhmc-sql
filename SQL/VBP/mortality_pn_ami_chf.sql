SELECT Med_Rec_No
, PtNo_Num
, CAST(Adm_Date AS DATE)  AS [Adm_Date]
, MONTH(Adm_Date)         AS [Adm_Month]
, YEAR(Adm_Date)          AS [Adm_Yr]
, CAST(Dsch_Date AS DATE) AS [Dsch_Date]
, MONTH(Dsch_Date)        AS [Dsch_Month]
, YEAR(Dsch_Date)         AS [Dsch_Yr]
, CAST(Days_Stay AS INT)  AS [LOS]
, Pt_Age
, Pt_Sex
, CASE
	WHEN prin_dx_cd IN (
		-- ICD-9
	'410', '410.01', '401.02', '410.1', '410.11', '410.12', 
	'410.2', '410.21', '410.22', '410.3', '410.31', '410.32', 
	'410.4', '410.41', '410.42', '410.5', '410.51', '410.52', 
	'410.6', '410.61', '410.62', '410.7', '410.71', '410.72', 
	'410.8', '410.81', '410.82', '410.9', '410.91', '410.92', 
	'997.1', 
	-- ICD-10 CODES
	'i21.09', 'i21.09', 'I21.09', 'I21.09', 'I21.09', 'I21.09', 
	'I21.09', 'I21.09', 'I21.09', 'I21.11', 'I21.11', 'I21.11', 
	'I21.19', 'I21.19', 'I21.19', 'I21.29', 'I21.29', 'I21.29', 
	'I21.29', 'I21.29', 'I21.29', 'I21.4', 'I21.4', 'I21.4', 
	'I21.29', 'I21.29', 'I21.29', 'I21.3', 'I21.3', 'I21.3', 
	'I97.190'
	)
		THEN 'AMI'
	WHEN prin_dx_cd IN (
		-- ICD-9 CODES
	'428.0','428.1','428.20','428.21','428.22',
	'428.23','428.30','428.31','428.32','428.33','428.40',
	'428.41','428.42','428.43','428.9','429.4','402.01',
	'402.11','402.91','404.91','404.93',
	-- ICD-10 CODES
	'I50.9', 'I50.1', 'I50.20', 'I50.21', 'I50.22', 'I50.23', 
	'I50.30', 'I50.31', 'I50.32', 'I50.33', 'I50.40', 'I50.41', 
	'I50.42', 'I50.43', 'I97.0', 'I97.110', 'I97.130', 'I197.190', 
	'I11.0', 'I13.0', 'I13.2'
	)
		THEN 'CHF'
	WHEN prin_dx_cd IN (
		-- ICD-9
	'480', '480.1', '480.2', '480.3', '480.8', '480.9', '481', '482', 
	'482.1', '482.2', '482.3', '482.31', '482.32', '482.39', '482.4', 
	'482.41', '482.42', '482.49', '482.81', '482.82', '482.83', 
	'482.89', '482.9', '483', '483.1', '483.8', '484.1', '484.3', 
	'484.5', '484.6', '484.7', '484.8', '517.1', '485', '486', '507', 
	'507.1', '507.8', '506', 
	-- ICD-10 CODES
	'J12.0', 'j12.1', 'J12.2', 'J12.81', 'J12.89', 'J12.9', 'J13', 
	'J18.1', 'J15.0', 'J15.1', 'J14', 'J15.4', 'J15.4', 'J15.3', 
	'J15.4', 'J15.20', 'J15.211', 'J15.212', 'J15.29', 'J15.8', 
	'J15.5', 'J15.6', 'J15.8', 'J15.9', 'J15.7', 'J16.0', 'J16.8', 
	'B25.0', 'A37.91', 'A22.1', 'B44.0', 'J17', 'J17', 'J17', 
	'J18.0', 'J18.9', 'J69.0', 'J69.1', 'J69.8', 'J68.0'
	)
		THEN 'PN'
  END AS 'Condition'
, CASE
	WHEN LEFT (dsch_disp, 1) IN ('C', 'D')
		THEN 1
		ELSE 0
  END AS [Mortality_Flag]
, CASE
	WHEN LEFT(dsch_disp, 1) NOT IN ('C', 'D')
		THEN 1
		ELSE 0
  END AS [Discharge_Alive_Flag]

FROM SMSDSS.BMH_PLM_PtAcct_V

WHERE Dsch_Date >= '2009-01-01'
AND Dsch_Date < '2016-01-01'
AND prin_dx_cd IN (
	-- AMI
	-- ICD-9
	'410', '410.01', '401.02', '410.1', '410.11', '410.12', 
	'410.2', '410.21', '410.22', '410.3', '410.31', '410.32', 
	'410.4', '410.41', '410.42', '410.5', '410.51', '410.52', 
	'410.6', '410.61', '410.62', '410.7', '410.71', '410.72', 
	'410.8', '410.81', '410.82', '410.9', '410.91', '410.92', 
	'997.1', 
	-- ICD-10 CODES
	'i21.09', 'i21.09', 'I21.09', 'I21.09', 'I21.09', 'I21.09', 
	'I21.09', 'I21.09', 'I21.09', 'I21.11', 'I21.11', 'I21.11', 
	'I21.19', 'I21.19', 'I21.19', 'I21.29', 'I21.29', 'I21.29', 
	'I21.29', 'I21.29', 'I21.29', 'I21.4', 'I21.4', 'I21.4', 
	'I21.29', 'I21.29', 'I21.29', 'I21.3', 'I21.3', 'I21.3', 
	'I97.190',

	-- CHF
	-- ICD-9 CODES
	'428.0','428.1','428.20','428.21','428.22',
	'428.23','428.30','428.31','428.32','428.33','428.40',
	'428.41','428.42','428.43','428.9','429.4','402.01',
	'402.11','402.91','404.91','404.93',
	-- ICD-10 CODES
	'I50.9', 'I50.1', 'I50.20', 'I50.21', 'I50.22', 'I50.23', 
	'I50.30', 'I50.31', 'I50.32', 'I50.33', 'I50.40', 'I50.41', 
	'I50.42', 'I50.43', 'I97.0', 'I97.110', 'I97.130', 'I197.190', 
	'I11.0', 'I13.0', 'I13.2',

	-- Pneumonia
	-- ICD-9
	'480', '480.1', '480.2', '480.3', '480.8', '480.9', '481', '482', 
	'482.1', '482.2', '482.3', '482.31', '482.32', '482.39', '482.4', 
	'482.41', '482.42', '482.49', '482.81', '482.82', '482.83', 
	'482.89', '482.9', '483', '483.1', '483.8', '484.1', '484.3', 
	'484.5', '484.6', '484.7', '484.8', '517.1', '485', '486', '507', 
	'507.1', '507.8', '506', 
	-- ICD-10 CODES
	'J12.0', 'j12.1', 'J12.2', 'J12.81', 'J12.89', 'J12.9', 'J13', 
	'J18.1', 'J15.0', 'J15.1', 'J14', 'J15.4', 'J15.4', 'J15.3', 
	'J15.4', 'J15.20', 'J15.211', 'J15.212', 'J15.29', 'J15.8', 
	'J15.5', 'J15.6', 'J15.8', 'J15.9', 'J15.7', 'J16.0', 'J16.8', 
	'B25.0', 'A37.91', 'A22.1', 'B44.0', 'J17', 'J17', 'J17', 
	'J18.0', 'J18.9', 'J69.0', 'J69.1', 'J69.8', 'J68.0'
)